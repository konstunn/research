
\documentclass[a4paper,12pt]{article}

\usepackage{cmap}

\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

\usepackage[a4paper,margin=1cm,footskip=.5cm,left=2cm,right=1.5cm,top=1.5cm,bottom=1.5cm]{geometry}
\usepackage{textcase}
\usepackage{csquotes}
\usepackage{enumitem}
\usepackage[textsize=tiny]{todonotes}
\usepackage{titlesec}
\usepackage{amsmath}
\usepackage{indentfirst}

\setcounter{secnumdepth}{4}

\setlist[description]{leftmargin=\parindent,labelindent=\parindent}

\begin{document}

\begin{titlepage}

	\begin{center}
		\MakeTextUppercase{ Министерство образования и науки
			Российской ~Федерации }
		\bigbreak
		ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ БЮДЖЕТНОЕ ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ
			ВЫСШЕГО ОБРАЗОВАНИЯ
		\bigbreak
		\MakeTextUppercase{\enquote{Новосибирский государственный технический
			университет}}
		\bigbreak\bigbreak

		Кафедра теоретической и прикладной информатики

		\vspace{200pt}

		\textbf{\LARGE{Отчет по}\\}
		\bigbreak
		учебной практике: \\
			практике по получению первичных профессиональных умений и навыков
		\bigbreak\bigbreak
		c 1 сентября по 31 октября

		\vspace{100pt}
	\end{center}

	\begin{flushleft}
		\begin{tabbing}
			Группа:\qquad\qquad\qquad	\= ПММ-61\\
			Студент:					\> Горбунов К. К.\\
			Место практики:				\> кафедра ТПИ НГТУ\\
			Руководитель:				\> доц. Черникова О. С.\\
		\end{tabbing}
	\end{flushleft}

	\begin{center}
		\vspace{\fill}
		Новосибирск, 2016 г.
	\end{center}

\end{titlepage}

\tableofcontents

\newpage

\section{Постановка задачи}

\subsection{Структурно-вероятностное описание модельной структуры}

Конечной целью исспедований в рамках магистерской диссертации является
разработка алгоритмов оценивания состояния стохастической непрерывно-дискретной
системы, модель которой описывается следующим образом:

\[ 
	\left\{ 
		\begin{array}{cl}
			\dot{x}(t) &= F(t) x(t) + C(t) u(t) + G(t) w(t)  \\ 
			y(k) &= H(k) x(k) + v(k) 
		\end{array} 
	\right. 
\]

Здесь:
\begin{description}
	\item [$x(t)$] -- вектор состояния;
	\item [$F(t)$] -- матрица эволюции объекта (системы);
	\item [$u(t)$] -- вектор управления (входа);
	\item [$C(t)$] -- матрица входа;
	\item [$w(t)$] -- вектор возмущений;
	\item [$G(t)$] -- матрица влияния возмущений;
	\item [$H(k)$] -- матрица наблюдений (измерений);
	\item [$v(k)$] -- шум измерений;
	\item [$y(k)$] -- вектор наблюдений;
\end{description}

В данной модели уравнение объекта является непрерывным, а уравнение наблюдений
--- дискретным. Такая модель является характерной для значительного множества
прикладных задач.

Один из видимых путей решения задачи оценивания состояния такой системы
является адаптация аналогичных алгоритмов, применимых к дискретным и
непрерывным системам, к данному непрерывно-дискретному случаю.

Разрабатываемый алгоритм также должен оценивать вероятностные характеристики
шумов объекта и измерений, потому как в реальных задачах вероятностные
характеристики данных процессов неизвестны или же эти процессы являются
нестационарными.

\section{Сравнительный анализ алгоритмов фильтрации}

\subsection{Краткое описание калмановских алгоритмов фильтрации}

Модельная структура:

\[
	\begin{array}{cl}
		x(k+1) &= F(k) x(k) + G(k) w(k)\\
		y(k) &= H(k) x(k) + v(k)
	\end{array}
\]

Априорные данные:\\
\[
\begin{array}{l}
	x(0) \sim N(x(0|0), P(0)); w(k) \sim N(0, Q(k));\\
	v(k) \sim N(0, R(k)); \\
	cov(w(k), w(j)) = Q(k) \delta_{kj}; cov(v(k), v(j)) = R(k) \delta_{kj}; \\
	cov(w(k) v(j)) = cov(x(0)w(k)) = cov(x(0)v(k)) = 0; \\
	\delta_{kj} \mbox{--- символ Кронекера; $k, j = 1, 2\cdots$}
\end{array}
\]
\newpage
Здесь:
\begin{description}
	\item [$P(k)$] -- ковариационная матрица состояния объекта;
	\item [$R(k)$] -- ковариационная матрица шумов наблюдений;
	\item [$Q(k)$] -- ковариационная матрица шумов объекта;
\end{description}

Алгоритм экстраполяции (прогноза) состояния объекта:

\[ x(k+1|k) = F(k+1|k)x(k|k); \]

Алгоритм экстраполяции ковариационной матрицы состояния:

\[ P(k+1|k) = F(k+1|k)P(k|k)F^T(k+1|k) + G(k+1|k)Q(k)G^T(k+1|k) \]

Алгоритм фильтрации состояния объекта:
\[ 
	\begin{array}{cl}
	&x(k|k) = x(k|k-1) + K_k (y(k) - H(k) x(k|k-1)) \\
	&K_k = P(k|k-1) H^T(k) {[ H(k) P(k|k-1) H^T(k) + R(k)]}^{-1}
	\end{array}
\]

Алгоритм обновления ковариации состояния объекта:
\[
	P(k|k) = (E - K_k H(k)) P(k|k-1)
\]

Оценка состояния системы формируется как прогноз по модели эволюции системы
с поправкой на прогноз результата наблюдений по модели наблюдений и сам
результат текущих наблюдений.

Поправка представляет собой разность текущих наблюдений и прогноза результата
наблюдений.

Поправка имеет вес (усиление), который определяется исходя из степени доверия к
результатам текущих наблюдений относительно прогноза состояния системы по
модели.

В простейшем варианте калмановской процедуры ($\alpha$-$\beta$ фильтр [1]) вес
поправки на всех итерациях является постоянной величиной.

\subsubsection{Недостатки классического алгоритма Калмана}

Классический фильтр Калмана является оптимальным при некоторых ограниченных
условиях.

Корреляционная матрица состояния и коэффициент усиления определяются на основе
только априорной информации и не зависит от поступающих значений наблюдений.
Поэтому проблема обеспечения точными априорными данными является одной из
основных трудностей при практическом использовании классических алгоритмов
Калмана [2].

Возможны проблемы при реализации средствами вычислительной техники, связанные с
ошибками машинного округления, в результате которых может некорректно
вычисляться коэффициент усиления [2].

\newpage

\subsection{Модификации классических калмановских процедур}

\subsubsection{Фильтрация при наличии аномальных измерений}

\paragraph{Модели измерений с переменными переключения\\}

Модель системы:
\[ x_{k+1} = F(k+1|k) x_k + G(k+1|k) w_k \]

Модель измерений:
\[ y_k = \gamma_k H_k x_k + B_k v_k \]

Априорная информация:
\[ 	
\begin{array}{l}
	x(0) \sim N(x(0|0), P(0)); w_k \sim N(0, Q(k)); v_k \sim N(0, R(k)); \\
	cov(w_k, w_j) = Q(k)\delta_{kj}; cov(v_k, v_j) = R(k)\delta_{kj}; \\
	cov(w_k, v_j) = cov(x_0, w_k) = cov(x_0, v_k) = 0; \\
	k, j = 1, 2\ldots; \\
	\gamma_k = 
	\left\{ 
		\begin{array}{lr}
			1 \mbox{ с вероятностью } q_k; \\
			0 \mbox{ с вероятностью } 1-q_k; \\
		\end{array}
	\right. \\
	\mbox{$\gamma_k$ не зависит от $x(0), w_k, v(k)$ и $\gamma(j), j \ne i $}
\end{array}
\]

Алгоритм фильтрации задается реккурентными соотношениями
\[
	\begin{array}{l}
	x(k|k) = x(k|k-1) + \hat{K_k}(y(k) - q_k H_k x(k|k-1)); \\
	\hat{K_k} = q_k P(k|k-1) H^T_k [ q_k H_k + (q_k P(k|k-1) + \\
		 + (1 - q_k) s(k|k-1)) H^T_k + B_k R_k B^T_k ]^{-1}; \\
	P(k|k-1) = (E - q_k \hat{K_k} H_k) P(k|k-1); P(0|0) = P_0 .
	\end{array}
\]

Алгоритм экстраполяции задается соотношениями
\begin{equation*}
	\begin{split}
	&s(k+1|k) = F(k+1|k) s(k|k) F^T(k+1|k) + G(k+1|k) Q_k G^T(k+1|k) \\
	&\mbox{при } s(0|0) = P_0 + x(0|0) x^T(0|0), \\
	&\mbox{где } s(k+1|k) = M_{xy}[ x_{k+1} x^T_{k+1} | Y^k_1 ]
	\end{split}
\end{equation*}

Переключается компонента состояния объекта в модели измерений. Каждое
наблюдение либо содержит информацию о состоянии объекта, либо не содержит.

Модель объекта дискретная.

Должна быть известна вероятность переключения.

\paragraph{Робастный алгоритм Ершова-Липцера\\}

Модель объекта:
\[ x_{k+1} = a_0(k) + a_1(k)x_k + a_2(k) y_k + w_{k+1} \]

Модель измерений:
\begin{equation*}
	y_{k+1} = A_0(k) + A_1(k) x_k + A_2(k) y_k
	+ (1 - \lambda_{k+1}) v_{k+1} + \lambda_{k+1} \varepsilon_{k+1}
\end{equation*}

Априорные данные и начальные условия:
\[
	\begin{array}{l}
		w_{k+1} \sim N(0, Q_{k+1}); v_{k+1} \sim N(0, R_{k+1}); \\
		\varepsilon_{k+1} \sim N(0, D_{k+1}); x_0 \sim N(\bar{x_0}, P_0); \\

		cov\left( 
		\begin{array}{cc} 
			\left[ \begin{array}{cc} w_k \\ v_k \end{array} \right]  
			,\left[ \begin{array}{cc} w_j \\ v_j \end{array} \right]
		\end{array}
		\right) 
		= 
		\left[ \begin{array}{cc} Q_k & C_k \\ C^T_k & R_k \end{array} \right]
			\delta_{kj}; \\

		cov\left( 
		\begin{array}{cc} 
			\left[ \begin{array}{cc} v_k \\ \varepsilon_k \end{array} \right]  
			,\left[ \begin{array}{cc} v_j \\ \varepsilon_j \end{array} \right]
		\end{array}
		\right) 
		= 
		\left[ \begin{array}{cc} R_k & 0 \\ 0 & D_k \end{array} \right]
			\delta_{kj}; \\

	\end{array}
\]

Случайные величины $\lambda_k$ принимают независимые значения 0 или 1;
последовательность ${\{(\lambda_k); k=1,2,\ldots\}}$ и гауссовская случайная
величина $x_0$ не зависят от ${\{(w_k), (v_k), (\varepsilon_k), k=1,2,\ldots\}}$ 
и $y_0$.

Дополнительные ограничения --- алгоритм оценки параметра $\lambda_{k+1}$
задается в следующем виде:

\[ 
	\hat{\lambda}_{k+1} = \left\{ 
	\begin{array}{cc} 
		1, \mbox{ при } |\Lambda_{k+1}| > \hat{c}(k, \alpha), \\
		0, \mbox{ при } |\Lambda_{k+1}| < \tilde{c}(k, \alpha)
	\end{array} \right.
\]
\indent где 
\[ \Lambda_{k+1} = y_{k+1} - A_0(k) - A_1(k) n_k - A_2(k) y_k ; \]
\[ n_{k+1} = a_0(k) + a_1(k) n_k + a_2(k) y_k; n_0 = \bar{x}_0. \]

При априорно известном $\alpha$ константа $c(k, \alpha)$ --- решение уравнения
\[ P(|\Lambda_{k+1}| \leq \tilde{c}(k, \alpha)|\lambda_{k+1} = 0) = \alpha .\]

Алгоритм фильтрации состояния объекта:
\begin{equation*}
	\begin{split}
	\hat{x}(k+1|k+1) = a_0(k) + a_1(k) \hat{x}(k|k) + a_2(k) y_k +\\
	+ K_{k+1} (y_{k+1} - A_0(k) - A_1(k) \hat{x}(k|k) - A_2(k) y_k);
	\end{split}
\end{equation*}

Алгоритм эволюции ковариации:
\begin{equation*}
	\begin{split}
		\hat{P}(k+1) = a_1^2(k) \hat{P}(k|k) + Q_k - K_{k+1}
		[(1-\hat{\lambda}_{k+1})C_k + a_1(k) \hat{P}(k|k) A_1(k)];
	\end{split}
\end{equation*}
\indent где
\[ x(0|0) = \bar{x}_0, \hat{P}(0|0) = P_0. \]

Моделируется ситуация ``загрязнения'' канала наблюдения редко появляющимися, но
мощными дополнительными помехами.

Модель объекта дискретная.

Шум наблюдений ``переключается'': то на шум с меньшей дисперсией, то с
б\'{о}льшей. Шумы гауссовские центрированные с известными дисперсиями.

Должна быть известна вероятность переключения.

\subsection{Адаптивные алгоритмы фильтрации}

Алгоритмы, учитывающие появления аномальных наблюдений при априорной
статистической неопределенности.

\subsubsection{Реккурентное оценивание состояния и корреляционной матрицы шумов
измерений}

\paragraph{Оценивание постоянной корреляционной матрицы\\}

Модель системы:

\[ x_{k+1} = a_0(k) + F(k+1|k) x_k + b(k) w_k . \]

Модель измерений:

\[ y_k = A_0(k) + H_k x_k + B_k v_k . \]

Априорные данные:

\[ 
\begin{array}{l}
	w_k \sim N(0; Q_k); v_k \sim N(0; R);\\
	R - const; R - \mbox{неизвестная матрица}; x_0 \sim N(x(0|0), P_0);\\
	cov(w_k, w_j) = cov(w_k, v_j) = cov(x_0, v_k) = cov(x_0, w_k) = 0; k \ne j.
\end{array}
\]

Критерий оптимизации --- максимум совместной плотности распределения
вероятностей оцениваемых и измеряемых параметров

\[ \underset{X_1^k, R}{max}\, p(X_1^k, Y_1^k | R), \]

Алгоритм экстраполяции значений

\[ x(k+1|k) = M(x_{k+1}|Y^k_1); P(k+1|k) = cov(x_{k+1}, x{k+1} | Y^k_1) \]

имеет вид

\[
\begin{array}{l}
	x(k+1|k) = a_0(k) + F(k+1|k) x(k|k);\\
	P(k+1|k) = F(k+1|k) P(k|k) F^T(k+1|k) + b(k) Q^k b^T(k).
\end{array}
\]

Алгоритм фильтрации значений $x(k|k) = M(x_k|Y^k_1)$ и 
$P(k|k) = cov(x_k, x_k | Y^k_1)$ задается реккурентными соотношениями

\[
\begin{array}{l}
	x(k|k) = x(k|k-1) + K_k v_k;\\
	K_k = P(k|k-1) H^T_k C^{-1}_k;\\
	v_k = y_k - A_0(k) - H^k x(k|k-1);\\
	C_k = H_k P_(k|k-1) H^T_k + B_k \hat{R_k} B^T_k;\\
	P(k|k) = (E - K_k H_k) P(k|k-1);\\
	\hat{R_k} = (1/k) (B^T_k B_k)^{-1} B^T_k (v_k v^T_k) B_k (B^T_k B_k)^{-1} +
	(1 - 1/k) \hat{R_{k-1}} .
\end{array}
\]

\paragraph{Оценивание непостоянной корреляционной матрицы\\}

Модель системы:

\[ x_{k+1} = a_0(k) + F(k+1|k) x_k + b(k) w_k . \]

Модель измерений:

\[ y_k = A_0(k) + H_k x_k + B_k v_k . \]

Априорные данные:

\[ 
\begin{array}{l}
	w_k \sim N(0; Q_k); v_k \sim N(0; R_k);\\
	R \ne const; R - \mbox{неизвестная матрица}; x_0 \sim N(x(0|0), P_0);\\
	cov(w_k, w_j) = cov(w_k, v_j) = cov(x_0, v_k) = cov(x_0, w_k) = 0; k \ne j.
\end{array}
\]

Критерий оптимизации ---

\[ \underset{X_k, R_k}{max}\, p(x_k, y_k | Y_1^{k-1}, R_k), \]

Алгоритм фильтрации имеет вид

\[ 
	\begin{array}{l}
		x(k|k) = x(k|k-1) + K_k v_k; \\
		K_k = P(k|k-1) H_k^T \hat{C}_k^{-1}; \\
		\hat {C}_k = v_k v_k^T; \\
		v_k = y_k - H_k x(k|k-1); \\
		P(k|k) = P(k|k-1) - K_k C_k K_k^T. \\
	\end{array}
\]

\section*{Заключение}
\addcontentsline{toc}{section}{Заключение}

Проведен краткий обзор алгоритмов реккурентного оценивания состояния,
в том числе в условиях априорной статистической, параметрической
неопределенностях. Рассмотрены алгоритмы, каждый из которых удовлетворительно
решает задачу при соответствующих определенных априорных данных.

\section*{Список источников}
\addcontentsline{toc}{section}{Список источников}


1. Bar-Shalom, Yakov. Estimation with Application to Tracking and Navigation\\
2. Огарков М. А. Методы статистического оценивания параметров случайных 
процессов\\
3. Ершов, Липцер. Робастный фильтр Калмана в дискретном времени

\end{document}
